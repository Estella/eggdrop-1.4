WARNING WARNING WARNING WARNING WARNING WARNING

This TODO is more up to date (as of August 26th, 1999) than 
previous copies. Before working on a TODO item you may wanna
subscribe to eggdev@eggheads.org (http://scrambled.eggheads.org/
mailman/listinfo/eggdev) and ask if there is anyone working on 
that TODO item.

TODO list for eggdrop1.3.29

When you have done something on this list or done anything that
requires you to send a patch file please do the following:

- make the patch file by diff'ng eggdrop1.3 and your changed
  eggdrop directory, for example:
    
    diff -bur eggdrop1.3 patched1.3 > myfirstpatch
    
- please do not patch src/patch.h

- please do not renumber the TODO, instead just remove what you
  fixed or say that you have submitted a patch

- and when you e-mail the patch to eggdev, please put

    PATCH: <patch name>
    
  in the subject line, this is because it makes it easier for us
  to track patch files.
  
and thats about all ... 

----
PROBLEM STATUS
----

	1:	no one
	2:	no one
	3:	Segfault (maybe ??)
	4:	Mixter had submitted a patch
	5:	no one
	6:	no one
	7:	no one
	8:	no one
	9:	no one
        10:     no one
	11: 	no one
	12:	Tothwolf/Cybah
	13:	no one
	14: 	no one
	15:	no one
	16:	no one
	17:	no one
	18:	drummer (but he needs help)

----
TODO LIST
----

1. SEGV with sharing. Don't know how to reproduce this bug, but it
occurs again and again (Found by TheUnknown). Here are two DEBUG files:

Context: userent.c/940, [SEGV with sharing bug track - added 99/03/26]
         userent.c/942, [SEGV with sharing bug track - added 99/03/26]
         share:share.c/1095, [SEGV with sharing bug track - added 99/03/26]
         share:share.c/1121, [SEGV with sharing bug track - added 99/03/26]
         share:share.c/1095, []
         share:share.c/1121, [SEGV with sharing bug track]
         userent.c/489, []
         userent.c/495, [SEGV with sharing bug track]
         share:share.c/1095, []
         share:share.c/1121, [SEGV with sharing bug track]
         userent.c/932, []
         userent.c/934, [SEGV with sharing bug track]
         userent.c/936, [e->u.list is NULL!]
         userent.c/937, [e is valid]
         userent.c/940, [SEGV with sharing bug track - added 99/03/26]
         userent.c/942 [SEGV with sharing bug track - added 99/03/26]

Context: share:share.c/1095, []
         share:share.c/1121, [SEGV with sharing bug track]
         share:share.c/1095, []
         share:share.c/1121, [SEGV with sharing bug track]
         userent.c/101, []
         userent.c/125, []
         share:share.c/1095, [SEGV with sharing bug track - added 99/03/26]
         share:share.c/1121, [SEGV with sharing bug track - added 99/03/26]
         share:share.c/1095, [e->u.list is NULL!]
         share:share.c/1121, [e is valid]
         userent.c/932, []
         userent.c/934, [SEGV with sharing bug track]
         userent.c/936, [e->u.list is NULL!]
         userent.c/937, [e is valid]
         userent.c/940, [SEGV with sharing bug track - added 99/03/26]
         userent.c/942 [SEGV with sharing bug track - added 99/03/26]

--
2. CTCP flood a bot, it ignores you, then channel flood, it won't kick
you. It should ignore CTCP and not ignore ALL (found by Plex/Harry).

note: there is no such thing as a CTCP ignore, will code this for
1.3.28. users.h - line 153, and detect_flood() in servmsg.c - line 283. <cybah>

--
3. +h flag seems to be redundant with .strip (confusing)

Status: SegFault is working on this

--
4. ./configure not detecting static tcl being incompatible with modules in
    some situations (ask details to Tothwolf).

Status: Mixter did a patch for this, however his method stopped the configure
        from working on all systems ...

--
5. +shared/+s flags need to be recoded. The way all this works seems to be
confusing for users.

NOTE: +shared is now default ... howver the +g share flag should be recode 
      because it tends to be rather buggy ...

Status: noone is working on this

--
6. some users asked for mIrc bantypes (1/2/3/4) for the eggdrop. A setting
has to be added to allow the bot-owner to choose the banmask type he wants
his bot to use. not before 1.3.28.

<drummer> .kickban command already supports different bantypes...

Status: noone is working on this

--
7. fix the eggdrop/tcl8.* info exist bug.

Status: noone is working on this

--
8. rewrite the eggdrop server queue, like Cybah's bot. not before 1.3.28.

Status: Cybah ?

--
9. From the eggheads list: <cybah>

I think there is a minor bug in the way
how botnets restructure...

dcc!leafy *** Unlinked oldhub (restructure)
dcc!leafy [17:13] ERROR linking newhub: Already connected.
dcc!leafy [17:13] Lost bot: newhub

problem here is, that they delink from the old hub
and link to the newly designated (or alternate) hub
immediately, but that hub doesnt have the information
that leafy unlinked from newhub yet (botnet lag), so it will
say error: already connceted. making the bots wait
for about 2 seconds before re-linking would fix this

Mixter

--
10.

There are some english sentences in the C src. They should be moved to
/language. We also need some coordination between the different
languages.

Status: no one

--
11.

(poptix' report)
[20:10] !!! writing to nonexistent socket: 6
[20:10] * Last context: botnet.c/1350 []
[20:10] * Wrote DEBUG
[20:10] * SEGMENT VIOLATION -- CRASHING!

Debug (eggdrop v1.3.27) written Sun May  2 20:10:00 1999
Full Patch List:
Using tcl library: /usr/lib/tcl8.0 (header version 8.0)
Compile flags: gcc
Link flags   : gcc
Strip flags  : strip
Context: chanprog.c/533, []
         chanprog.c/545, []
         chanprog.c/533, []
         chanprog.c/539, []
         tcl.c/463, []
         tclmisc.c/351, []
         tclmisc.c/147, []
         tcldcc.c/503, []
         tcldcc.c/503, []
         tcldcc.c/503, []
         tcldcc.c/503, []
         tcldcc.c/503, []
         main.c/495, []
         users.c/827, []
         main.c/436, []
         botnet.c/1350 []

and (TheUnknown's report):

[13:00] !!! writing to nonexistent socket: 13
[13:00] * Last context: botnet.c/1350 []
[13:00] * Wrote DEBUG
[13:00] * SEGMENT VIOLATION -- CRASHING!

Debug (eggdrop v1.3.27) written Sun May  2 13:00:00 1999
Full Patch List:
STATICALLY LINKED
Using tcl library: ./tcl8.0/library (header version 8.0)
Compile flags: gcc
Link flags   : gcc
Strip flags  : strip
Context: tclhash.c/900, []
         chanprog.c/530, []
         chanprog.c/533, []
         chanprog.c/545, []
         chanprog.c/533, []
         chanprog.c/545, []
         main.c/495, []
         irc:irc.c/372, []
         irc:irc.c/372, []
         irc:irc.c/372, []
         irc:irc.c/372, []
         users.c/827, []
         main.c/436, []
         botnet.c/1350 []

Status: no one is working on this.

--
12. Eggdrop won't work with TCL 8.1 libs compiled with --enable-threads

(Ian White's report)

Debug (eggdrop v1.3.27) written Sun May  2 22:54:09 1999
Full Patch List:
Compile flags: gcc -DEBUG_MEM
Link flags   : gcc -g
Strip flags  : touch
Context: main.c/526, []
         main.c/526, []
         main.c/526, []
         main.c/526, []
         main.c/526, []
         main.c/526, []
         main.c/526, []
         main.c/526, []
         main.c/526, []
         main.c/526, []
         main.c/526, []
         main.c/526, []
         main.c/537, []
         language.c/284, []
         language.c/86, []
         modules.c/430 []

This seems to occur with thread compile tcl 8.1.

Status: Tothwolf/Cybah are working on this.

--
13. We need a better solution to the non-rfc-complient networks than to remove
    -DRFC_COMPLIENT from the Makefile. Need to make rfc_casecmp a pointer to a
    function and check net-type whenever the config file is loaded. Obviously
    with this approach, net-type has to be set readonly because we cant check
    when it's value is changed on a running bot. Anyone who changes it
    on-the-fly is mad anyway :p If net-type is set on a known non rfc-complient
    network, we just point rfc_casecmp at strcasecmp.. otherwise to the proper
    functions <Cybah>

Status: drummer submitted a patch to eggdev

14. after you end a relay session with a bot and your using a dcc
    connection, shouldn't eggdrop turn off telnet codes automatically?

Status: no-one is working on this

--
15. This is an odd one, and I've included code that should reproduce it...
    (Tothwolf)
   =TestBot= [04:12] joined #TestChannel but didn't want to!

   bind time - "?0 * * * *" time:join:channel
   bind time - "?5 * * * *" time:join:channel
   proc time:join:channel {min hour day month year} {
     test:join:channel
     return 0
   }

   proc test:join:channel {} {
     channel add #TestChannel
     puthelp "PRIVMSG #TestChannel :I'm here!"
     timer 1 "catch {channel remove #TestChannel}"
     return 0
   }

Status: no-one is working on this

--
16. notes rejection (to ignore notes from some user@bot that keeps 
    annoying them)

Status: no-one is working on this

--
17. .resetbans #channel doesn't work properly (ask Tothwolf for details).

Status: no-one is working on this

--
18. Bug report from drummer

=dcc(bot)= .+user user
=dcc(bot)= .tcl setuser user HOSTS n!u@h
=dcc(bot)= .tcl setuser user HOSTS none
[dcc(bot)] [01:00] *** ATTEMPTING TO FREE NON-MALLOC'D PTR: tcluser.c (493)

07/15/1999 workaround bugfix applied to CVS, someone has to recheck it
	   Also need a patch:
	   .tcl setuser user XTRA blah "asfdasfd"
	   ...
	   .tcl setuser user XTRA blah ""
	   blah field will be empty, but i should be removed.

Status: 	drummer, but need help
